# Orca W95 Theme Plugin

一个为 Orca Note 设计的复古 Windows 95 风格主题插件，提供丰富的界面定制功能和模块化的插件系统。

## ✨ 功能特性

### 🎨 主题系统
- **W95 风格主题**：复古 Windows 95 界面风格
- **主题2切换**：额外的复古配色方案
- **亮色/暗色模式**：自动适配系统主题
- **外部CSS加载**：支持动态主题文件加载

### 🛠️ 界面定制功能

#### 1. 查询视图切换 (优先级 1)
- **功能**：切换查询视图的显示模式
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的查询视图按钮，在列表视图和卡片视图之间切换

#### 2. 标题编号切换 (优先级 2)
- **功能**：自动为标题添加编号（H1, H2, H3...）
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的标题编号按钮，自动为所有标题添加层级编号

#### 3. 属性折叠切换 (优先级 3)
- **功能**：折叠/展开属性块
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的属性折叠按钮，一键折叠或展开所有属性块

#### 4. 块引用隐藏切换 (优先级 4)
- **功能**：隐藏仅块引用内容
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的块引用隐藏按钮，隐藏所有仅包含块引用的内容

#### 5. 块引用高亮切换 (优先级 5)
- **功能**：高亮仅块引用内容
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的块引用高亮按钮，高亮显示所有仅包含块引用的内容

#### 6. 镜像容器切换 (优先级 6)
- **功能**：隐藏/显示镜像容器
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的镜像容器按钮，隐藏或显示镜像容器

#### 7. 列表面包屑切换 (优先级 7)
- **功能**：隐藏/显示列表面包屑
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的列表面包屑按钮，隐藏或显示列表中的面包屑导航

#### 8. 卡片视图极简切换 (优先级 8)
- **功能**：隐藏/显示卡片标题和面包屑
- **按钮**：工具栏图标按钮
- **状态**：持久化保存
- **使用方法**：点击工具栏中的卡片极简按钮，隐藏或显示卡片中的标题和面包屑

#### 9. 卡片封面比例切换 (优先级 9)
- **功能**：控制卡片封面的宽高比
- **选项**：1:1, 16:9, 3:2, 11:16, 自动
- **按钮**：工具栏图标按钮（循环切换）
- **状态**：持久化保存
- **使用方法**：点击工具栏中的卡片比例按钮，循环切换不同的封面比例

#### 10. 查询列表块创建时间显示 (优先级 10)
- **功能**：在查询列表块中显示创建时间
- **特性**：按时间段着色（凌晨、上午、中午、下午、晚上）
- **按钮**：工具栏图标按钮（开关控制）
- **状态**：持久化保存
- **使用方法**：点击工具栏中的创建时间按钮，开启或关闭创建时间显示功能

#### 11. 主题2切换 (优先级 11)
- **功能**：切换到复古风格主题2
- **特性**：外部CSS文件加载，复古配色方案
- **按钮**：工具栏图标按钮（画笔/调色板图标）
- **状态**：持久化保存
- **使用方法**：点击工具栏中的主题2按钮，在默认主题和复古主题2之间切换

#### 12. 隐藏OCR图片块 (优先级 12)
- **功能**：控制OCR图片块的显示/隐藏
- **状态**：关闭 → 隐藏OCR图片块 → 仅显示OCR图片块
- **按钮**：搜索模态框底部按钮
- **状态**：持久化保存
- **使用方法**：在搜索模态框中点击OCR图片块按钮，循环切换三种状态

## 🚀 使用方法

### 安装插件
1. 在右侧 Releases 选择最新版本下载
2. 插件放置到对应位置后需要重启 Orca Note

### 基本使用
1. **工具栏控制**：通过工具栏按钮控制各种功能
2. **状态持久化**：所有设置自动保存，重启后保持
3. **主题切换**：可以随时在默认主题和主题2之间切换

### 详细使用指南

#### 标题编号功能
启用后自动为标题添加层级编号：
```markdown
# 1 项目概述
## 1.1 项目背景
### 1.1.1 技术选型
## 1.2 项目目标
### 1.2.1 短期目标
### 1.2.2 长期目标
# 2 技术架构
## 2.1 前端技术
## 2.2 后端技术
```

#### 卡片封面比例切换
点击按钮循环切换不同比例：
- **1:1**：正方形封面
- **16:9**：宽屏比例
- **3:2**：标准比例
- **11:16**：竖屏比例
- **自动**：根据内容自适应

#### 创建时间显示功能
- **自动检测**：自动为查询列表块添加创建时间
- **时间段着色**：
  - 凌晨（0-6点）：蓝色
  - 上午（6-12点）：绿色
  - 中午（12-14点）：黄色
  - 下午（14-18点）：橙色
  - 晚上（18-24点）：紫色

#### OCR图片块管理
在搜索模态框底部点击按钮循环切换：
- **关闭**：显示所有块（默认状态）
- **隐藏OCR图片块**：只显示普通文本块
- **仅显示OCR图片块**：只显示OCR图片块

#### 主题2切换
- **默认主题**：显示画笔图标，点击切换到主题2
- **主题2**：显示调色板图标，点击切换回默认主题
- **特色**：复古配色、网格背景、特殊边框设计

#### 属性折叠功能
- **折叠状态**：所有属性块显示为折叠状态
- **展开状态**：所有属性块显示为展开状态
- **一键切换**：点击按钮即可切换所有属性块的显示状态

#### 块引用管理
- **隐藏功能**：隐藏所有仅包含块引用的内容
- **高亮功能**：高亮显示所有仅包含块引用的内容
- **独立控制**：两个功能可以独立开启或关闭

## 📁 插件结构目录

```
orca-W95-theme/
├── dist/                     # 编译后的代码
│   ├── index.js              # 插件主文件
│   └── css/                  # 主题样式文件
│       ├── theme.css         # 主主题样式
│       └── theme2.css        # 主题2样式
├── src/
│   ├── main.ts               # 插件入口文件
│   ├── types.ts              # 所有插件的类型定义
│   ├── constants.ts          # 所有插件的配置常量
│   ├── css/                  # 源样式文件
│   │   ├── theme.css         # 主主题样式
│   │   └── theme2.css        # 主题2样式
│   ├── js/
│   │   ├── index.ts          # 导出所有插件和工具
│   │   ├── utils/            # 工具函数
│   │   └── plugins/          # 各个插件实现
│   │       ├── queryViewToggle.ts
│   │       ├── headingNumberToggle.ts
│   │       ├── propsToggle.ts
│   │       ├── queryBlockRefToggle.ts
│   │       ├── queryBlockHighlightToggle.ts
│   │       ├── mirrorContainerToggle.ts
│   │       ├── listBreadcrumbToggle.ts
│   │       ├── cardViewMinimalToggle.ts
│   │       ├── cardCoverAspectRatioToggle.ts
│   │       ├── queryListBlockCreationTime.ts
│   │       ├── theme2Toggle.ts
│   │       └── ocrImageBlockToggle.ts
│   └── translations/
│       └── zhCN.ts           # 中文翻译
├── plugin-docs/              # 插件文档
├── package.json              # 项目配置
├── tsconfig.json             # TypeScript 配置
├── vite.config.ts            # Vite 构建配置
└── README.md                 # 项目说明
```

## 🔧 配置选项

### 插件优先级
所有插件按优先级排序显示在工具栏中：

1. **查询视图切换** (优先级 1)
2. **标题编号切换** (优先级 2)
3. **属性折叠切换** (优先级 3)
4. **块引用隐藏切换** (优先级 4)
5. **块引用高亮切换** (优先级 5)
6. **镜像容器切换** (优先级 6)
7. **列表面包屑切换** (优先级 7)
8. **卡片视图极简切换** (优先级 8)
9. **卡片封面比例切换** (优先级 9)
10. **查询列表块创建时间显示** (优先级 10)
11. **主题2切换** (优先级 11)
12. **隐藏OCR图片块** (优先级 12)

### 状态持久化
所有插件设置都保存在 `localStorage` 中：
- `w95.queryViewHidden`
- `w95.headingNumberEnabled`
- `w95.propsCollapsed`
- `w95.queryBlockRefHidden`
- `w95.queryBlockHighlighted`
- `w95.mirrorContainerHidden`
- `w95.listBreadcrumbHidden`
- `w95.cardViewMinimal`
- `w95.cardCoverAspectRatio`
- `w95.queryListBlockCreationTimeEnabled`
- `w95.theme2Loaded`
- `w95.ocrImageBlockState`

## 📊 工作原理

### 初始化流程
1. **插件加载**：注册所有模块化插件
2. **按钮管理**：初始化统一的工具栏按钮管理系统
3. **状态恢复**：从 localStorage 恢复所有插件状态
4. **DOM监听**：启动 MutationObserver 监听界面变化

### 模块化架构
- **统一接口**：所有插件都实现相同的接口
- **优先级系统**：通过数字优先级控制按钮显示顺序
- **状态管理**：每个插件独立管理自己的状态
- **错误处理**：完善的错误处理和重试机制

### 主题系统
- **主主题**：通过 `orca.themes.register` 注册
- **主题2**：动态加载外部CSS文件
- **样式隔离**：使用唯一的ID避免样式冲突
- **动态切换**：支持运行时主题切换

## 🎨 视觉特性

### W95 风格设计
- **复古配色**：经典的 Windows 95 配色方案
- **圆角设计**：适度的圆角元素
- **阴影效果**：立体感的阴影设计
- **图标系统**：统一的 SVG 图标设计

### 主题2特色
- **复古配色**：更浓郁的复古风格
- **网格背景**：点状网格背景效果
- **特殊边框**：独特的边框设计
- **色彩丰富**：更丰富的色彩搭配

## 🐛 故障排除

### 常见问题

**Q: 插件没有自动运行**
- 检查插件是否已启用
- 查看控制台是否有错误信息
- 尝试重新启动 Orca Note

**Q: 按钮没有显示**
- 检查工具栏是否存在
- 查看控制台错误信息
- 尝试刷新页面

**Q: 主题2没有加载**
- 检查 `css/theme2.css` 文件是否存在
- 查看网络请求是否成功
- 检查控制台错误信息

**Q: 状态没有保存**
- 检查 localStorage 是否可用
- 查看控制台错误信息
- 尝试清除浏览器缓存

### 调试信息
打开开发者工具（F12）查看控制台输出：

```javascript
// 正常日志
✅ W95 主题插件已加载
✅ 所有工具栏按钮已按顺序添加
✅ W95 查询视图切换模块已初始化
✅ W95 标题编号切换模块已初始化
// ... 其他模块初始化日志

// 错误日志
❌ 无法加载主题2 CSS文件: [错误信息]
❌ 状态保存失败: [错误信息]
```

## 📝 更新日志

### v1.0.0
- 初始版本发布
- 支持 12 个模块化功能插件
- 实现 W95 风格主题
- 添加主题2切换功能
- 支持状态持久化
- 添加多语言支持

### 功能模块
- ✅ 查询视图切换
- ✅ 标题编号切换
- ✅ 属性折叠切换
- ✅ 块引用隐藏切换
- ✅ 块引用高亮切换
- ✅ 镜像容器切换
- ✅ 列表面包屑切换
- ✅ 卡片视图极简切换
- ✅ 卡片封面比例切换
- ✅ 查询列表块创建时间显示
- ✅ 主题2切换
- ✅ 隐藏OCR图片块

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 查看 LICENSE 文件了解详情。

## 🙏 致谢

- **Orca Note** - 优秀的笔记应用
- **Orca Plugin Template** - 插件开发模板
- **Tabler Icons** - 图标库

## 📞 支持

如果您遇到问题或有建议，请：

1. 查看 **故障排除** 部分
2. 搜索现有的 Issues
3. 创建新的 Issue 并提供详细信息

---

**享受复古的 W95 风格笔记体验！** 🎨✨